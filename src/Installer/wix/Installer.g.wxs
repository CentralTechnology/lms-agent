<?xml version="1.0" encoding="Windows-1252"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
  <Product Id="e05fe767-9b78-4434-9ebc-3a9c1ad7a409" Name="License Monitoring System" Language="1033" Codepage="Windows-1252" Version="!(bind.FileVersion.LMS.exe)" UpgradeCode="adac7706-188b-42e7-922b-50786779042a" Manufacturer="Central Technology Ltd">
    <Package InstallerVersion="200" Compressed="yes" Platform="x64" SummaryCodepage="Windows-1252" Languages="1033" InstallScope="perMachine" />
    <Media Id="1" Cabinet="License_Monitoring_System.cab" EmbedCab="yes" />

    <Condition Message="Please install the appropriate .NET version first.">WIX_IS_NETFRAMEWORK_452_OR_LATER_INSTALLED</Condition>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder" Name="ProgramFiles64Folder">
        <Directory Id="INSTALLDIR" Name="License Monitoring System">

          <Component Id="Component.LMS.exe" Guid="e05fe767-9b78-4434-9ebc-3a9cf4f0a306" Win64="yes">
            <File Id="LMS.exe" Source="LMS.exe" />

            <ServiceInstall Id="LicenseMonitoringSystem" Name="LicenseMonitoringSystem" DisplayName="License Monitoring System" Description="A tool used to monitor various licenses." Type="ownProcess" Start="auto" ErrorControl="normal" Vital="yes">
              <ServiceConfig DelayedAutoStart="yes" ServiceSid="none" OnInstall="yes" OnReinstall="no" OnUninstall="no" />
              <ServiceConfig FirstFailureActionType="restart" SecondFailureActionType="restart" ThirdFailureActionType="restart" ResetPeriodInDays="1" RestartServiceDelayInSeconds="30" xmlns="http://schemas.microsoft.com/wix/UtilExtension" />
            </ServiceInstall>

            <ServiceControl Id="StopLicenseMonitoringSystem" Name="LicenseMonitoringSystem" Stop="both" Wait="yes" />
            <ServiceControl Id="StartLicenseMonitoringSystem" Name="LicenseMonitoringSystem" Start="install" Wait="no" />
            <ServiceControl Id="RemoveLicenseMonitoringSystem" Name="LicenseMonitoringSystem" Remove="uninstall" Wait="yes" />
          </Component>

          <Component Id="Component.App.config" Guid="e05fe767-9b78-4434-9ebc-3a9c57399228" Win64="yes">
            <File Id="App.config" Source="App.config" />
          </Component>

          <Component Id="Component.Installer.csproj" Guid="e05fe767-9b78-4434-9ebc-3a9cb0ad6d50" Win64="yes">
            <File Id="Installer.csproj" Source="Installer.csproj" />
          </Component>

          <Component Id="Component.packages.config" Guid="e05fe767-9b78-4434-9ebc-3a9c2d387c79" Win64="yes">
            <File Id="packages.config" Source="packages.config" />
          </Component>

          <Component Id="Component.Program.cs" Guid="e05fe767-9b78-4434-9ebc-3a9c2f934466" Win64="yes">
            <File Id="Program.cs" Source="Program.cs" />
          </Component>

          <Component Id="Component.setup.wixpdb" Guid="e05fe767-9b78-4434-9ebc-3a9c6f307f4d" Win64="yes">
            <File Id="setup.wixpdb" Source="setup.wixpdb" />
          </Component>

          <Component Id="Component.setup.wxs" Guid="e05fe767-9b78-4434-9ebc-3a9cc65b7fa9" Win64="yes">
            <File Id="setup.wxs" Source="setup.wxs" />
          </Component>

          <Component Id="ComponentDirPermission" Guid="e05fe767-9b78-4434-9ebc-3a9c7877ec06" Win64="yes" KeyPath="yes">
            <CreateFolder>
              <PermissionEx User="LocalSystem" GenericExecute="yes" GenericWrite="yes" xmlns="http://schemas.microsoft.com/wix/UtilExtension" />
            </CreateFolder>
            <RemoveFolder Id="INSTALLDIR" On="uninstall" />
          </Component>

        </Directory>
      </Directory>
    </Directory>

    <PropertyRef Id="WIX_IS_NETFRAMEWORK_452_OR_LATER_INSTALLED" />

    <MajorUpgrade DowngradeErrorMessage="A later version of [ProductName] is already installed. Setup will now exit." Schedule="afterInstallInitialize" />

    <CustomAction Id="Set_ARPNOMODIFY" Property="ARPNOMODIFY" Value="True" Return="check" Execute="immediate" />

    <UIRef Id="WixUI_Common" />

    <Property Id="ARPHELPTELEPHONE" Value="0845 413 88 99" />
    <Property Id="ARPNOREPAIR" Value="True" />

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="Component.LMS.exe" />
      <ComponentRef Id="Component.App.config" />
      <ComponentRef Id="Component.Installer.csproj" />
      <ComponentRef Id="Component.packages.config" />
      <ComponentRef Id="Component.Program.cs" />
      <ComponentRef Id="Component.setup.wixpdb" />
      <ComponentRef Id="Component.setup.wxs" />
      <ComponentRef Id="ComponentDirPermission" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="Set_ARPNOMODIFY" After="InstallInitialize"> (NOT Installed) </Custom>
    </InstallExecuteSequence>

  </Product>
</Wix>

